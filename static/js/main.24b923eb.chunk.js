(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{64:function(e,t,r){},68:function(e,t,r){},69:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),c=r(12),s=r.n(c),i=r(8),o=r(53),l=r(38),u=r(13),j=r(34),b=r(33),d=r(51),m=r(40),f=r(39),O=r(28),h=r(16),p=r(5);function x(e){var t=e.show,r=e.handleClose;return Object(p.jsxs)(h.a,{show:t,onHide:r,children:[Object(p.jsx)(h.a.Header,{closeButton:!0,children:Object(p.jsx)(h.a.Title,{children:"About"})}),Object(p.jsx)(h.a.Body,{children:"About this page"}),Object(p.jsx)(h.a.Footer,{children:Object(p.jsx)(O.a,{variant:"primary",onClick:r,children:"Close"})})]})}var v=r(26),g=r.n(v),y=r(41);function S(e){var t=e.stream;return null!=t.thumbnail?Object(p.jsx)("a",{href:t.link,onClick:function(e){console.log(e),function(e,t){for(;null!=t;){if(e===t)return!0;t=t.parentElement}return!1}(e.currentTarget,e.target)||e.preventDefault()},children:Object(p.jsx)("img",{src:t.thumbnail,alt:t.title})}):Object(p.jsx)("iframe",{src:"https://www.youtube.com/embed/".concat(t.streamId),width:"240",height:"135",title:t.title,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",frameBorder:"0"})}var w=r(24);function k(){var e=Object(n.useState)(Object(w.a)()),t=Object(i.a)(e,2),r=t[0],a=t[1],c=Object(n.useState)(Object(w.b)()),s=Object(i.a)(c,2),o=s[0],l=s[1],u=Object(n.useState)(Object(w.a)()),j=Object(i.a)(u,2),b=j[0],d=j[1],m=Object(n.useState)(!1),f=Object(i.a)(m,2),O=f[0],h=f[1];return Object(n.useEffect)((function(){O||fetch("data/latest.json").then((function(e){return e.json()})).then((function(e){a(e.vtubers.reduce((function(e,t){return e.has(t.vtuberId)?e:e.set(t.vtuberId,t)}),r));var t=e.streams.reduce((function(e,t){return e.has(t.streamId)?e:e.set(t.streamId,function(e){return{streamId:e.streamId,vtuberId:e.vtuberId,source:e.source,title:e.title,link:e.link,thumbnail:e.thumbnail,startTime:new Date(e.startTime),endTime:null!=e.endTime?new Date(e.endTime):null,membership:1===e.membership}}(t))}),o);l(t),d(t.valueSeq().groupBy((function(e){return e.vtuberId})).map((function(e){return e.toList()})).toMap()),h(!0)})).catch((function(e){return console.error(e)}))}),[O,o,r]),{vtubers:r,streams:o,streamsByVtuber:b}}function C(e){var t=e.nameDisplay,r=e.vtuber;return Object(p.jsxs)("a",{href:r.link,children:[Object(p.jsx)("img",{src:r.thumbnail,alt:r.name}),Object(p.jsx)("br",{}),"original"===t?r.name:"romaji"===t?r.romanizedName:r.shortName]})}var T=1+Math.random();function I(e){for(var t=0,r=0;r<e.length;r++)t+=e.charCodeAt(r);return t*T%1}function D(e){var t=e.parent,r=e.sitePref,a=e.sortPref,c=Object(n.useRef)(null),o=Object(n.useState)(!0),l=Object(i.a)(o,2),u=l[0],j=l[1],b=Object(n.useState)(null),d=Object(i.a)(b,2),m=d[0],f=d[1],O=function(e,t){var r=Object(n.useState)(),a=Object(i.a)(r,2),c=a[0],s=a[1];return Object(n.useEffect)((function(){var r=setInterval((function(){var t=e();c!==t&&s(t)}),t);return function(){return clearInterval(r)}}),[e,t,c]),c}((function(){var e;return null===(e=t.current)||void 0===e?void 0:e.offsetHeight}),500),h=k(),x=h.vtubers,v=h.streams,w=h.streamsByVtuber,T=Object(n.useMemo)((function(){return new y.a(x.mapEntries((function(e){var t,n,a=Object(i.a)(e,2),c=a[0],o=a[1],l=document.createElement("div");l.className="vtuber",s.a.render(Object(p.jsx)(C,{nameDisplay:r.get("nameDisplay"),vtuber:o}),l);var u=new Date,j=null!==(t=null===(n=function(e,t,r){var n=t.get(e.vtuberId);return null==n||0===n.size?null:n.minBy((function(e){return Math.abs(e.startTime.getTime()-r.getTime())}))}(o,w,u))||void 0===n?void 0:n.startTime.getTime())&&void 0!==t?t:1/0;return[c,{id:c,content:l,popularity:o.popularity,closestStream:Math.abs(u.getTime()-j)}]})).valueSeq().toArray())}),[r,w,x]),D=Object(n.useMemo)((function(){return new y.a(v.mapEntries((function(e,t){var r=Object(i.a)(e,2),n=r[0],a=r[1],c=document.createElement("div");return c.className="stream",s.a.render(Object(p.jsx)(S,{stream:a}),c),[n,{id:n,group:a.vtuberId,content:c,start:a.startTime,limitSize:!1,title:a.title,style:"\n                  z-index: ".concat(t,";\n                ")}]})).valueSeq().toArray())}),[v]);return Object(n.useEffect)((function(){var e=new y.b(c.current,new y.a);return f(e),function(){return e.destroy()}}),[]),Object(n.useEffect)((function(){null!=m&&(m.setData({groups:T,items:D}),m.redraw(),u&&(m.setWindow(g()().subtract(8,"hours").toDate(),g()().add(24,"hours").toDate()),j(!1)))}),[u,T,D,m]),Object(n.useEffect)((function(){var e;null!=m&&m.setOptions({align:"left",groupOrder:(e=a.get("sortBy"),"popularity"===e?function(e,t){return t.popularity-e.popularity}:"next stream"===e?function(e,t){return e.closestStream-t.closestStream}:"random"===e?function(e,t){return I(e.id)-I(t.id)}:void 0),orientation:"top",selectable:!1,stack:!1,tooltip:{followMouse:!0,delay:0},min:g()().subtract(10,"days").toDate(),max:g()().add(10,"days").toDate(),zoomMin:g.a.duration(4,"hours").asMilliseconds(),zoomMax:g.a.duration(2,"weeks").asMilliseconds(),zoomKey:"ctrlKey",verticalScroll:!0,maxHeight:(null!==O&&void 0!==O?O:1e3)-16})}),[O,m,a]),Object(p.jsx)("div",{ref:c})}function N(e){var t=e.show,r=e.handleClose;return Object(p.jsxs)(h.a,{show:t,onHide:r,children:[Object(p.jsx)(h.a.Header,{closeButton:!0,children:Object(p.jsx)(h.a.Title,{children:"Search Help"})}),Object(p.jsx)(h.a.Body,{children:"About this page"}),Object(p.jsx)(h.a.Footer,{children:Object(p.jsx)(O.a,{variant:"primary",onClick:r,children:"Close"})})]})}function P(e,t){var r=Object(n.useState)(function(e,t){var r=localStorage.getItem(e);if(null!=r)try{return t(JSON.parse(r))}catch(n){return t()}return t()}(e,t)),a=Object(i.a)(r,2),c=a[0],s=a[1];return[c,Object(n.useCallback)((function(t){localStorage.setItem(e,JSON.stringify(t.toJSON())),s(t)}),[e]),Object(n.useCallback)((function(){localStorage.removeItem(e),s(t())}),[t,e])]}var z=[{name:"UTC",identifier:"UTC",offset:0},{name:"PDT",identifier:"America/Los_Angeles",offset:480}],B=["original","romaji","short"],M=["next stream","popularity","random"];var E={timezone:function(){var e=(new Date).getTimezoneOffset(),t=z.reduce((function(t,r){return Math.abs(e-r.offset)<Math.abs(e-t.offset)?r:t}));return null!=t?t:z[0]}(),nameDisplay:"original"},A=Object(w.c)(E),H=Object(w.c)({search:""}),J=Object(w.c)({sortBy:"next stream"});r(64),r(65);var L=function(){var e=Object(n.useState)(!1),t=Object(i.a)(e,2),r=t[0],a=t[1],c=Object(n.useState)(!1),s=Object(i.a)(c,2),O=s[0],h=s[1],v=Object(n.useRef)(null),g=function(){var e=P("site",A),t=Object(i.a)(e,3),r=t[0],a=t[1],c=t[2],s=P("filter",H),o=Object(i.a)(s,3),l=o[0],u=o[1],j=o[2],b=P("sort",J),d=Object(i.a)(b,3),m=d[0],f=d[1],O=d[2];return{sitePref:r,setSitePref:a,filterPref:l,setFilterPref:u,sortPref:m,setSortPref:f,reset:Object(n.useCallback)((function(){c(),j(),O()}),[c,j,O])}}(),y=g.sitePref,S=g.setSitePref,w=g.sortPref,k=g.setSortPref,C=g.reset,T=Object(n.useCallback)((function(){window.confirm("Press OK to clear all bookmarks, filters, etc. from this web page.")&&C()}),[C]);return Object(p.jsxs)("div",{className:"app d-flex flex-column h-100",children:[Object(p.jsxs)(m.a,{children:[Object(p.jsx)(m.a.Brand,{href:"#",children:"VTuber Schedules"}),Object(p.jsx)(m.a.Toggle,{"aria-controls":"navbar"}),Object(p.jsx)(m.a.Collapse,{id:"navbar",children:Object(p.jsxs)(d.a,{className:"ml-auto",children:[Object(p.jsx)(d.a.Link,{href:"#clear",onClick:T,children:"Clear Data"}),Object(p.jsx)(d.a.Link,{href:"#about",onClick:function(){return a(!0)},children:"About"}),Object(p.jsx)(f.a,{id:"timezone",title:y.get("timezone").name,children:z.map((function(e){return Object(p.jsx)(f.a.Item,{onClick:function(){return S(y.set("timezone",e))},children:e.name},e.name)}))}),Object(p.jsx)(f.a,{id:"name_display",title:y.get("nameDisplay"),children:B.map((function(e){return Object(p.jsx)(f.a.Item,{className:"text-capitalize",onClick:function(){return S(y.set("nameDisplay",e))},children:e},e)}))})]})})]}),Object(p.jsx)(o.a,{fluid:!0,className:"px-2",children:Object(p.jsx)(j.a,{children:Object(p.jsxs)(j.a.Row,{children:[Object(p.jsx)(j.a.Group,{as:l.a,className:"m-0",children:Object(p.jsxs)(b.a,{className:"mb-2 mr-sm-2",children:[Object(p.jsx)(b.a.Prepend,{children:Object(p.jsx)(b.a.Text,{children:"Search:"})}),Object(p.jsx)(j.a.Control,{id:"search",placeholder:"v:pikamee g:voms title"}),Object(p.jsx)(b.a.Append,{children:Object(p.jsx)(b.a.Text,{className:"help",onClick:function(){return h(!0)},children:"?"})})]})}),Object(p.jsx)(j.a.Group,{as:l.a,className:"m-0",children:Object(p.jsxs)(u.a,{children:[Object(p.jsxs)(u.a.Toggle,{id:"sort",className:"text-capitalize",children:["Sort by: ",w.get("sortBy")]}),Object(p.jsx)(u.a.Menu,{children:M.map((function(e){return Object(p.jsx)(u.a.Item,{className:"text-capitalize",onClick:function(){return k(w.set("sortBy",e))},children:e},e)}))})]})})]})})}),Object(p.jsx)(o.a,{fluid:!0,className:"schedule p-2",ref:v,children:Object(p.jsx)(D,{parent:v,sitePref:y,sortPref:w})}),Object(p.jsx)(x,{show:r,handleClose:function(){return a(!1)}}),Object(p.jsx)(N,{show:O,handleClose:function(){return h(!1)}})]})};r(68);s.a.render(Object(p.jsx)(a.a.StrictMode,{children:Object(p.jsx)(L,{})}),document.getElementById("root"))}},[[69,1,2]]]);
//# sourceMappingURL=main.24b923eb.chunk.js.map