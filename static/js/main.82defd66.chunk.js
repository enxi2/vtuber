(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{73:function(e,t,n){},75:function(e,t,n){},79:function(e,t,n){},80:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(13),s=n.n(a),i=n(7),o=n(9),l=n(33),u=n.n(l),j=n(56),b=n(19),d=n(35),f=n(61),m=n(58),h=n(22),O=n(42),x=n(36),v=n(50),p=n(40),g=n(25),k=n(16),N=n(59),C=n(62),T=n(2);function I(e){var t=e.children,n=e.className,r=void 0===n?"":n,c=Object(C.a)(e,["children","className"]);return Object(T.jsx)("span",Object(N.a)(Object(N.a)({className:"material-icons ".concat(r)},c),{},{children:t}))}function w(e){var t=e.show,n=e.handleClose,c=e.notificationPermission,a=e.showNotification,s=Object(r.useState)(!1),o=Object(i.a)(s,2),l=o[0],u=o[1];return Object(T.jsxs)(k.a,{className:"about-modal",show:t,onHide:n,children:[Object(T.jsx)(k.a.Header,{closeButton:!0,children:Object(T.jsx)(k.a.Title,{children:"VTuber Streams"})}),Object(T.jsxs)(k.a.Body,{children:[Object(T.jsx)("p",{children:"A page to check, search, and get notifications about VTuber streams."}),Object(T.jsxs)("ul",{children:[Object(T.jsxs)("li",{children:[Object(T.jsx)(I,{children:"star_outline"})," to bookmark a VTuber"]}),Object(T.jsxs)("li",{children:[Object(T.jsx)(I,{children:"notifications_none"})," to receive notifications for a VTuber (notifications are"," ",Object(T.jsx)("b",{children:"granted"===c?"allowed":"blocked"}),","," ",Object(T.jsx)(g.a,{className:"align-baseline",onClick:function(){return a("Test notification","This is a test notification","#","".concat("/vtuber","/placeholder.png"))},variant:"outline-primary",children:"test notification"}),")"]}),Object(T.jsxs)("li",{children:[Object(T.jsx)("b",{children:"Clear Data"})," will clear all data on this website"]})]}),Object(T.jsxs)("p",{children:["Send questions or feedback to"," ",l?Object(T.jsx)("a",{href:"mailto:erin.xi@outlook.com",children:"erin.xi@outlook.com"}):Object(T.jsx)(g.a,{className:"align-baseline",onClick:function(){return u(!0)},variant:"outline-primary",children:"Show Email"})," ","or"," ",Object(T.jsx)("a",{href:"https://discordapp.com/users/659617582298562570",target:"_blank",rel:"noreferrer",children:"enxi#0410"}),"."]})]}),Object(T.jsx)(k.a.Footer,{children:Object(T.jsx)(g.a,{variant:"primary",onClick:n,children:"Close"})})]})}var S;n(73);function P(e,t){return null==e.endTime&&t.valueOf()>e.startTime.getTime()?S.LIVE:t.valueOf()>=e.startTime.getTime()?S.ENDED:S.UPCOMING}function y(e){for(var t=0,n=0;n<e.length;n++)'"'===e.charAt(n)&&t++;return t}function E(e){return function(e){for(var t=e.split(" "),n=[],r=0,c=0;c<t.length;c++)r%2===1?n[n.length-1]+=" "+t[c].replaceAll('"',""):n.push(t[c].replaceAll('"',"")),r+=y(t[c]);return n}(e).map((function(e){return function(e){var t=e.toLowerCase();if(t.startsWith("v:")){var n=t.substring(2);return{matches:function(e,t){var r=t.get(e.vtuberId);return null!=r&&(r.name.toLowerCase().includes(n)||r.romanizedName.toLowerCase().includes(n))}}}if(t.startsWith("g:")){var r=t.substring(2);return{matches:function(e,t){var n=t.get(e.vtuberId);return null!=n&&n.groupName.toLowerCase().includes(r)}}}return"bookmark"===t||"bookmarks"===t?{matches:function(e,t,n){var r=t.get(e.vtuberId);return null!=r&&n.has(r.vtuberId)}}:"notification"===t||"notifications"===t?{matches:function(e,t,n,r){var c=t.get(e.vtuberId);return null!=c&&r.has(c.vtuberId)}}:{matches:function(e,n){var r=n.get(e.vtuberId);return e.title.toLowerCase().includes(t)||e.vtuberId.toLowerCase().includes(t)||null!=r&&(r.name.toLowerCase().includes(t)||r.romanizedName.toLowerCase().includes(t))}}}(e)})).filter((function(e){return null!=e}))}function L(e){var t=e.now,n=e.streams,c=e.vtubers,a=e.bookmarks,s=e.setBookmarks,o=e.notifications,l=e.setNotifications,j=e.filterPref,d=e.setScrollToCurrentStream,f=Object(r.useRef)(null),m=Object(r.useState)(!0),h=Object(i.a)(m,2),O=h[0],x=h[1],p=Object(r.useMemo)((function(){var e=E(j.get("search"));return n.valueSeq().filter((function(t){return e.every((function(e){return e.matches(t,c,a,o)}))})).toList()}),[a,j,o,n,c]),g=Object(r.useMemo)((function(){return p.valueSeq().sort((function(e,n){var r,c,a=P(e,t),s=P(n,t);return a!==s?a<s?-1:1:a===S.ENDED?(null!==(r=e.endTime)&&void 0!==r?r:e.startTime).getTime()-(null!==(c=n.endTime)&&void 0!==c?c:n.startTime).getTime():e.startTime.getTime()-n.startTime.getTime()})).toList()}),[p,t]),k=Object(r.useMemo)((function(){var e;return null!==(e=g.find((function(e){return null==e.endTime&&t.valueOf()>e.startTime.getTime()||t.valueOf()<e.startTime.getTime()})))&&void 0!==e?e:null}),[t,g]),N=Object(r.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(null!=f.current&&null!=k){var t=document.getElementById(k.streamId);if(null!=t)return t.scrollIntoView(e?{behavior:"smooth"}:void 0),!0}return!1}),[k]);Object(r.useEffect)((function(){d((function(){return N}))}),[N,d]);var C=Object(r.useMemo)((function(){return g.map((function(e){var n,r=e.vtuberId,i=c.get(r);if(null==i)return null;var j=a.has(r),d=o.has(r),f=u()(e.startTime),m=null!=e.endTime?u()(e.endTime):null,h=P(e,t);return Object(T.jsxs)(v.a,{id:e.streamId,className:"stream-item d-flex flex-row m-0 py-2 ".concat(S[h].toLowerCase()," ").concat((null===k||void 0===k?void 0:k.streamId)===e.streamId?"next-stream":""),children:[Object(T.jsxs)(b.a,{xs:2,md:1,className:"stream-toggles text-center",children:[Object(T.jsx)("div",{className:"toggle-bookmark ".concat(j?"active":""),onClick:function(){return s(j?a.remove(r):a.add(r))},children:Object(T.jsx)(I,{children:j?"star":"star_outline"})}),Object(T.jsx)("br",{}),Object(T.jsx)("div",{className:"toggle-notification ".concat(d?"active":""),onClick:function(){return l(d?o.remove(r):o.add(r))},children:Object(T.jsx)(I,{children:d?"notifications_active":"notifications_none"})})]}),Object(T.jsx)(b.a,{xs:4,md:2,lg:1,className:"stream-vtuber p-0",children:Object(T.jsxs)("a",{href:i.link,children:[Object(T.jsx)("img",{src:i.thumbnail,alt:i.name}),Object(T.jsx)("br",{}),i.shortName]})}),Object(T.jsx)(b.a,{xs:6,md:3,lg:2,className:"stream-info p-0 text-center",children:Object(T.jsx)("a",{href:e.link,target:"_blank",rel:"noreferrer",children:Object(T.jsx)("img",{src:null!==(n=e.thumbnail)&&void 0!==n?n:"".concat("/vtuber","/placeholder.png"),alt:"Video thumbnail"})})}),Object(T.jsx)(b.a,{xs:12,md:6,className:"stream-title px-4 px-md-0 py-2 text-center text-md-left",children:Object(T.jsx)("a",{href:e.link,target:"_blank",rel:"noreferrer",children:e.title})}),Object(T.jsxs)(b.a,{xs:12,lg:2,className:"stream-time p-0 text-center",children:[f.format("h:mm A")," ",Object(T.jsx)("br",{className:"d-none d-lg-inline"}),Object(T.jsx)("i",{children:null!=m?"ended ".concat(m.from(t)):h===S.LIVE?"started ".concat(f.from(t)):"starting ".concat(f.from(t))})]})]},e.streamId)}))}),[a,s,o,l,k,t,g,c]);return Object(r.useEffect)((function(){O&&g.count()>0&&N()&&x(!1)}),[O,N,g]),Object(T.jsx)("div",{className:"list-schedule",ref:f,children:C})}function D(e){var t=e.show,n=e.handleClose;return Object(T.jsxs)(k.a,{className:"search-help-modal",show:t,onHide:n,children:[Object(T.jsx)(k.a.Header,{closeButton:!0,children:Object(T.jsx)(k.a.Title,{children:"Search Help"})}),Object(T.jsxs)(k.a.Body,{children:[Object(T.jsx)("p",{children:"Use the search to filter for VTubers and streams. The following case-insensitive search terms are supported:"}),Object(T.jsxs)("ul",{children:[Object(T.jsxs)("li",{children:["General search terms such as ",Object(T.jsx)("code",{children:"pikamee"})," or"," ",Object(T.jsx)("code",{children:"supachat"})," filter both VTuber and video titles."]}),Object(T.jsxs)("li",{children:["Terms with spaces require surrounding quotes, such as"," ",Object(T.jsx)("code",{children:'"super chat"'}),"."]}),Object(T.jsxs)("li",{children:["Specific VTubers can be searched using the ",Object(T.jsx)("code",{children:"v:"})," prefix, such as ",Object(T.jsx)("code",{children:"v:pikamee"}),"."]}),Object(T.jsxs)("li",{children:["Specific groups can be searched using the ",Object(T.jsx)("code",{children:"g:"})," prefix. The supported groups are:",Object(T.jsxs)("ul",{children:[Object(T.jsx)("li",{children:Object(T.jsx)("code",{children:"g:hololive"})}),Object(T.jsx)("li",{children:Object(T.jsx)("code",{children:"g:voms"})})]})]}),Object(T.jsxs)("li",{children:["Save searches using the ",Object(T.jsx)(I,{children:"playlist_add"})," button."]})]})]}),Object(T.jsx)(k.a.Footer,{children:Object(T.jsx)(g.a,{variant:"primary",onClick:n,children:"Close"})})]})}!function(e){e[e.ENDED=0]="ENDED",e[e.LIVE=1]="LIVE",e[e.UPCOMING=2]="UPCOMING"}(S||(S={}));n(74);function A(e,t){var n=Object(r.useState)(function(e,t){var n=localStorage.getItem(e);if(null!=n)try{var r=JSON.parse(n);for(var c in r)Array.isArray(r[c])&&(r[c]=Object(o.a)(r[c]));return t(r)}catch(a){return t()}return t()}(e,t)),c=Object(i.a)(n,2),a=c[0],s=c[1];return[a,Object(r.useCallback)((function(t){localStorage.setItem(e,JSON.stringify(t.toJSON())),s(t)}),[e]),Object(r.useCallback)((function(){localStorage.removeItem(e),s(t())}),[t,e])]}function B(e){var t=Object(r.useState)(function(e){var t=localStorage.getItem(e);if(null!=t)try{return Object(o.e)(JSON.parse(t))}catch(n){console.error(n)}return Object(o.e)()}(e)),n=Object(i.a)(t,2),c=n[0],a=n[1];return[c,Object(r.useCallback)((function(t){localStorage.setItem(e,JSON.stringify(t.toArray())),a(t)}),[e])]}var V=[{name:"UTC",identifier:"UTC",offset:0},{name:"PDT",identifier:"America/Los_Angeles",offset:480}];var M={timezone:function(){var e=(new Date).getTimezoneOffset(),t=V.reduce((function(t,n){return Math.abs(e-n.offset)<Math.abs(e-t.offset)?n:t}));return null!=t?t:V[0]}(),nameDisplay:"original"},_={search:"",savedSearches:Object(o.a)()},J=Object(o.d)(M),q=Object(o.d)(_),z=Object(o.d)({sortBy:"next stream"});function H(){var e=Object(r.useState)(Object(o.b)()),t=Object(i.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(Object(o.c)()),s=Object(i.a)(a,2),l=s[0],u=s[1],j=Object(r.useState)(Object(o.b)()),b=Object(i.a)(j,2),d=b[0],f=b[1],m=Object(r.useCallback)((function(e){fetch("https://vtuber-streams-data.herokuapp.com/latest.json",{cache:"no-cache"}).then((function(e){return e.json()})).then((function(e){c(e.vtubers.reduce((function(e,t){return e.has(t.vtuberId)?e:e.set(t.vtuberId,t)}),Object(o.b)()));var t=e.streams.reduce((function(e,t){return e.has(t.streamId)?e:e.set(t.streamId,function(e){return{streamId:e.streamId,vtuberId:e.vtuberId,source:e.source,title:e.title,link:e.link,thumbnail:e.thumbnail,startTime:new Date(e.startTime),endTime:null!=e.endTime?new Date(e.endTime):null,membership:1===e.membership}}(t))}),Object(o.c)());u(t),f(t.valueSeq().groupBy((function(e){return e.vtuberId})).map((function(e){return e.toList()})).toMap())})).catch((function(e){return console.error(e)}))}),[]);return Object(r.useEffect)((function(){m();var e=Date.now(),t=setInterval((function(){m(e),e=Date.now()}),6e4);return function(){return clearInterval(t)}}),[m]),{vtubers:n,streams:l,streamsByVtuber:d}}n(75),n(76);var U=function(){return u.a.tz(void 0,u.a.tz.guess())};var F=function(){var e=Object(r.useState)(!1),t=Object(i.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(!1),s=Object(i.a)(a,2),l=s[0],u=s[1],g=Object(r.useRef)(null),k=Object(r.useState)(null),N=Object(i.a)(k,2),C=N[0],S=N[1],P=Object(r.useRef)(Object(o.b)()),y=function(e,t,n){var c=Object(r.useState)(n),a=Object(i.a)(c,2),s=a[0],o=a[1];return Object(r.useEffect)((function(){var n=setInterval((function(){var t=e();s!==t&&o(t)}),t);return function(){return clearInterval(n)}}),[e,t,s]),s}(U,1e4,U()),E=function(){var e=A("site",J),t=Object(i.a)(e,3),n=t[0],c=t[1],a=t[2],s=A("filter",q),l=Object(i.a)(s,3),u=l[0],j=l[1],b=l[2],d=A("sort",z),f=Object(i.a)(d,3),m=f[0],h=f[1],O=f[2],x=B("bookmarks"),v=Object(i.a)(x,2),p=v[0],g=v[1],k=B("notifications"),N=Object(i.a)(k,2),C=N[0],T=N[1];return{sitePref:n,setSitePref:c,filterPref:u,setFilterPref:j,sortPref:m,setSortPref:h,reset:Object(r.useCallback)((function(){a(),b(),O(),g(Object(o.e)()),T(Object(o.e)())}),[a,b,O,g,T]),bookmarks:p,setBookmarks:g,notifications:C,setNotifications:T}}(),V=E.sitePref,M=E.filterPref,_=E.setFilterPref,F=E.reset,G=E.bookmarks,R=E.setBookmarks,W=E.notifications,K=E.setNotifications,Q=function(){var e=Object(r.useState)("default"),t=Object(i.a)(e,2),n=t[0],c=t[1],a=Object(r.useCallback)((function(e,t,r,c){null!=window.Notification&&"granted"===n?new window.Notification(e,{body:t,icon:c}):Object(p.c)(Object(T.jsxs)("div",{className:"notification-toast",children:[Object(T.jsx)("img",{alt:"".concat(e," notification icon"),src:c}),Object(T.jsxs)("div",{children:[Object(T.jsx)("h1",{children:e}),Object(T.jsx)("p",{children:Object(T.jsx)("a",{href:r,rel:"noreferrer",target:"_blank",children:t})})]})]},r))}),[n]),s=Object(r.useCallback)((function(e){c(e)}),[]);return Object(r.useEffect)((function(){null!=window.Notification&&window.Notification.requestPermission().then((function(e){s(e)}))}),[s]),{notificationPermission:n,showNotification:a}}(),X=Q.notificationPermission,Y=Q.showNotification,Z=H(),$=Z.vtubers,ee=Z.streams,te=Object(r.useMemo)((function(){return M.get("search")}),[M]),ne=Object(r.useCallback)((function(e){return _(M.set("search",e))}),[M,_]),re=Object(r.useCallback)((function(){window.confirm("Press OK to clear all bookmarks, filters, etc. from this web page.")&&F()}),[F]),ce=Object(r.useCallback)((function(e){return ne(e.target.value)}),[ne]),ae=Object(r.useMemo)((function(){return M.get("savedSearches")}),[M]),se=Object(r.useCallback)((function(){var e=te.trim();e.length>0&&!ae.contains(e)&&_(M.set("savedSearches",ae.push(e)))}),[ae,te,M,_]),ie=Object(r.useCallback)((function(e){_(M.set("savedSearches",ae.remove(e)))}),[ae,M,_]);return Object(r.useEffect)((function(){P.current=ee.reduce((function(e,t){if(e.has(t.streamId)){if("before"===e.get(t.streamId)&&y.isAfter(t.startTime)){var n,r=$.get(t.vtuberId);if(W.has(r.vtuberId))Y("".concat(r.shortName,"'s stream is starting!"),t.title,t.link,null!==(n=t.thumbnail)&&void 0!==n?n:r.thumbnail);return e.set(t.streamId,"after")}return e}return e.set(t.streamId,y.isBefore(t.startTime)?"before":"after")}),P.current)}),[W,y,Y,ee,$]),Object(T.jsxs)("div",{className:"app d-flex flex-column h-100",children:[Object(T.jsx)(x.a,{expand:"md",children:Object(T.jsxs)(j.a,{className:"px-0 px-md-1",children:[Object(T.jsx)(x.a.Brand,{children:"VTuber Streams"}),Object(T.jsx)(x.a.Text,{className:"d-none d-sm-inline-block",children:y.format("h:mm A z")}),Object(T.jsx)(x.a.Toggle,{"aria-controls":"navbar"}),Object(T.jsx)(x.a.Collapse,{id:"navbar",children:Object(T.jsxs)(O.a,{className:"ml-auto",children:[Object(T.jsx)(O.a.Link,{className:"d-sm-none",href:"#",onClick:function(){return u(!0)},children:"Search Help"}),Object(T.jsx)(O.a.Link,{href:"#",onClick:re,children:"Clear Data"}),Object(T.jsx)(O.a.Link,{href:"#",onClick:function(){return c(!0)},children:"About"})]})})]})}),Object(T.jsx)(j.a,{className:"filters px-3 px-sm-0",children:Object(T.jsx)(v.a,{children:Object(T.jsx)(m.a.Group,{as:b.a,className:"m-0",children:Object(T.jsxs)(h.a,{className:"mb-2 mr-sm-2",children:[Object(T.jsx)(h.a.Prepend,{children:Object(T.jsx)(h.a.Text,{className:"scroll icon-button",onClick:function(){null!=C&&C(!0)},children:Object(T.jsx)("span",{className:"material-icons",children:"update"})})}),Object(T.jsx)(h.a.Prepend,{className:"d-none d-sm-flex",children:Object(T.jsx)(h.a.Text,{className:"search icon-button",onClick:function(){return u(!0)},children:Object(T.jsx)("span",{className:"material-icons",children:"search"})})}),Object(T.jsx)(m.a.Control,{id:"search",placeholder:"v:pikamee title bookmarks",onChange:ce,value:te}),Object(T.jsx)(h.a.Append,{children:Object(T.jsxs)(f.a,{title:"",menuAlign:"right",variant:"outline-secondary",children:[Object(T.jsx)(d.a.Item,{onClick:function(){return ne("")},children:"Clear search"},"clear"),ae.count()>0?ae.reverse().map((function(e,t){return Object(T.jsxs)(d.a.Item,{className:"d-flex",onClick:function(){return ne(e)},children:[e,Object(T.jsx)("div",{className:"clear-search ml-auto pl-2",children:Object(T.jsx)(I,{onClick:function(e){return ie(t),e.stopPropagation(),e.preventDefault(),!1},children:"clear"})},"clear")]},t)})).toJS():Object(T.jsx)(d.a.Header,{children:"No saved searches"})]})}),Object(T.jsx)(h.a.Append,{children:Object(T.jsx)(h.a.Text,{className:"save icon-button",onClick:se,children:Object(T.jsx)("span",{className:"material-icons",children:"playlist_add"})})})]})})})}),Object(T.jsx)(j.a,{className:"schedule px-0 mt-2",ref:g,children:Object(T.jsx)(L,{now:y,streams:ee,vtubers:$,sitePref:V,filterPref:M,bookmarks:G,setBookmarks:R,notifications:W,setNotifications:K,setScrollToCurrentStream:S})}),Object(T.jsx)(w,{show:n,handleClose:function(){return c(!1)},notificationPermission:X,showNotification:Y}),Object(T.jsx)(D,{show:l,handleClose:function(){return u(!1)}}),Object(T.jsx)(p.b,{autoClose:36e5,closeOnClick:!0,draggablePercent:50,hideProgressBar:!0,newestOnTop:!0,pauseOnFocusLoss:!1,position:"top-center",transition:p.a})]})};n(79);s.a.render(Object(T.jsx)(c.a.StrictMode,{children:Object(T.jsx)(F,{})}),document.getElementById("root"))}},[[80,1,2]]]);
//# sourceMappingURL=main.82defd66.chunk.js.map