(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{54:function(e,t,c){},55:function(e,t,c){},58:function(e,t,c){},59:function(e,t,c){"use strict";c.r(t);var r=c(0),s=c.n(r),n=c(20),a=c.n(n),i=c(7),o=c(37),l=c(14),j=c(26),b=c(24),u=c(38),d=c(27),h=c(34),m=c(11),f=c(1);function O(e){var t=e.children,c=e.className,r=void 0===c?"":c;return Object(f.jsx)("span",{className:"material-icons ".concat(r),children:t})}function x(e){var t=e.show,c=e.handleClose;return Object(f.jsxs)(m.a,{show:t,onHide:c,children:[Object(f.jsx)(m.a.Header,{closeButton:!0,children:Object(f.jsx)(m.a.Title,{children:"VTuber Schedules"})}),Object(f.jsxs)(m.a.Body,{children:[Object(f.jsx)("p",{children:"A page to check, search, and get notifications about VTuber streams."}),Object(f.jsxs)("ul",{children:[Object(f.jsxs)("li",{children:[Object(f.jsx)(O,{children:"star_outline"})," to bookmark a VTuber"]}),Object(f.jsxs)("li",{children:[Object(f.jsx)(O,{children:"notifications_none"})," to receive notifications for a VTuber (notifications are"," ",Object(f.jsx)("b",{children:"granted"===Notification.permission?"allowed":"blocked"}),")"]}),Object(f.jsxs)("li",{children:[Object(f.jsx)("b",{children:"Clear Data"})," will clear all data on this website"]})]}),Object(f.jsx)("p",{children:'Google Analytics is used to measure page views and user demographics (with user consent). To reset user consent, click the "Clear Data" button. All other data (search, bookmarks, notifications) are local to the web page.'}),Object(f.jsxs)("p",{children:["Send questions or feedback to"," ",Object(f.jsx)("a",{href:"mailto:erin.xi@outlook.com",children:"erin.xi@outlook.com"})," or"," ",Object(f.jsx)("a",{href:"https://discordapp.com/users/659617582298562570",target:"_blank",rel:"noreferrer",children:"enxi#0410"}),"."]})]}),Object(f.jsx)(m.a.Footer,{children:Object(f.jsx)(h.a,{variant:"primary",onClick:c,children:"Close"})})]})}var p=c(41),v=c.n(p),k=c(43),g=c(13);function T(){var e=Object(r.useState)(Object(g.a)()),t=Object(i.a)(e,2),c=t[0],s=t[1],n=Object(r.useState)(Object(g.b)()),a=Object(i.a)(n,2),o=a[0],l=a[1],j=Object(r.useState)(Object(g.a)()),b=Object(i.a)(j,2),u=b[0],d=b[1],h=Object(r.useState)(!1),m=Object(i.a)(h,2),f=m[0],O=m[1];return Object(r.useEffect)((function(){f||fetch("data/latest.json").then((function(e){return e.json()})).then((function(e){s(e.vtubers.reduce((function(e,t){return e.has(t.vtuberId)?e:e.set(t.vtuberId,t)}),c));var t=e.streams.reduce((function(e,t){return e.has(t.streamId)?e:e.set(t.streamId,function(e){return{streamId:e.streamId,vtuberId:e.vtuberId,source:e.source,title:e.title,link:e.link,thumbnail:e.thumbnail,startTime:new Date(e.startTime),endTime:null!=e.endTime?new Date(e.endTime):null,membership:1===e.membership}}(t))}),o);l(t),d(t.valueSeq().groupBy((function(e){return e.vtuberId})).map((function(e){return e.toList()})).toMap()),O(!0)})).catch((function(e){return console.error(e)}))}),[f,o,c]),{vtubers:c,streams:o,streamsByVtuber:u}}c(54);function N(e){var t=e.bookmarks,c=e.setBookmarks,s=e.notifications,n=e.setNotifications,a=Object(r.useRef)(null),o=Object(r.useState)(!0),j=Object(i.a)(o,2),b=j[0],u=j[1],d=T(),h=d.vtubers,m=d.streams,x=Object(r.useMemo)((function(){return m.valueSeq().sortBy((function(e){return e.startTime.getTime()})).toList()}),[m]),p=Object(r.useCallback)((function(){var e=x.find((function(e){return null==e.endTime&&Date.now()>e.startTime.getTime()||Date.now()<e.startTime.getTime()}));if(null!=a.current&&null!=e){var t=document.getElementById(e.streamId);if(null!=t)return t.scrollIntoView(),!0}return!1}),[x]),g=Object(r.useMemo)((function(){return x.map((function(e){var r,a=e.vtuberId,i=h.get(a),o=t.has(a),j=s.has(a),b=v()(e.startTime),u=null!=e.endTime?v()(e.endTime):null,d=null==e.endTime&&Date.now()>e.startTime.getTime();return Object(f.jsxs)(k.a,{id:e.streamId,className:"stream-item d-flex flex-row m-0 py-2 ".concat(d?"live":""),children:[Object(f.jsxs)(l.a,{xs:2,md:1,className:"stream-toggles text-center",children:[Object(f.jsx)("div",{className:"toggle-bookmark ".concat(o?"active":""),onClick:function(){return c(o?t.remove(a):t.add(a))},children:Object(f.jsx)(O,{children:o?"star":"star_outline"})}),Object(f.jsx)("br",{}),Object(f.jsx)("div",{className:"toggle-notification ".concat(j?"active":""),onClick:function(){return n(j?s.remove(a):s.add(a))},children:Object(f.jsx)(O,{children:j?"notifications_active":"notifications_none"})})]}),Object(f.jsx)(l.a,{xs:4,md:2,lg:1,className:"stream-vtuber p-0",children:Object(f.jsxs)("a",{href:i.link,children:[Object(f.jsx)("img",{src:i.thumbnail,alt:i.name}),Object(f.jsx)("br",{}),i.shortName]})}),Object(f.jsx)(l.a,{xs:6,md:3,lg:2,className:"stream-info p-0 text-center",children:Object(f.jsx)("a",{href:e.link,target:"_blank",rel:"noreferrer",children:Object(f.jsx)("img",{src:null!==(r=e.thumbnail)&&void 0!==r?r:"".concat("/vtuber","/placeholder.png"),alt:"Video thumbnail"})})}),Object(f.jsx)(l.a,{xs:12,md:6,className:"stream-title px-0 py-2 text-center text-md-left",children:Object(f.jsx)("a",{href:e.link,target:"_blank",rel:"noreferrer",children:e.title})}),Object(f.jsxs)(l.a,{xs:12,lg:2,className:"stream-time p-0 text-center",children:[b.format("h:mm A")," ",Object(f.jsx)("br",{className:"d-none d-lg-inline"}),Object(f.jsx)("i",{children:null!=u?"ended ".concat(u.fromNow()):d?"started ".concat(b.fromNow()):"starting ".concat(b.fromNow())})]})]},e.streamId)}))}),[t,c,s,n,x,h]);return Object(r.useEffect)((function(){b&&x.count()>0&&p()&&u(!1)}),[b,p,x]),Object(f.jsx)("div",{className:"list-schedule",ref:a,children:g})}function w(e){var t=e.show,c=e.handleClose;return Object(f.jsxs)(m.a,{show:t,onHide:c,children:[Object(f.jsx)(m.a.Header,{closeButton:!0,children:Object(f.jsx)(m.a.Title,{children:"Search Help"})}),Object(f.jsxs)(m.a.Body,{children:[Object(f.jsx)("p",{children:"Use the search to filter for VTubers and streams. The following case-insensitive search terms are supported:"}),Object(f.jsxs)("ul",{children:[Object(f.jsxs)("li",{children:["General search terms such as ",Object(f.jsx)("code",{children:"pikamee"})," or"," ",Object(f.jsx)("code",{children:"superchat"})," filter both VTuber and video titles."]}),Object(f.jsxs)("li",{children:["Terms with spaces require surrounding quotes, such as"," ",Object(f.jsx)("code",{children:'"super chat"'}),"."]}),Object(f.jsxs)("li",{children:["Specific VTubers can be searched using the ",Object(f.jsx)("code",{children:"v:"})," prefix, such as ",Object(f.jsx)("code",{children:"v:pikamee"}),"."]}),Object(f.jsxs)("li",{children:["Specific groups can be searched using the ",Object(f.jsx)("code",{children:"g:"})," prefix. The supported groups are:",Object(f.jsxs)("ul",{children:[Object(f.jsx)("li",{children:Object(f.jsx)("code",{children:"g:hololive"})}),Object(f.jsx)("li",{children:Object(f.jsx)("code",{children:"g:voms"})})]})]})]})]}),Object(f.jsx)(m.a.Footer,{children:Object(f.jsx)(h.a,{variant:"primary",onClick:c,children:"Close"})})]})}function S(e,t){var c=Object(r.useState)(function(e,t){var c=localStorage.getItem(e);if(null!=c)try{return t(JSON.parse(c))}catch(r){return t()}return t()}(e,t)),s=Object(i.a)(c,2),n=s[0],a=s[1];return[n,Object(r.useCallback)((function(t){localStorage.setItem(e,JSON.stringify(t.toJSON())),a(t)}),[e]),Object(r.useCallback)((function(){localStorage.removeItem(e),a(t())}),[t,e])]}function C(e){var t=Object(r.useState)(function(e){var t=localStorage.getItem(e);if(null!=t)try{return Object(g.d)(JSON.parse(t))}catch(c){console.error(c)}return Object(g.d)()}(e)),c=Object(i.a)(t,2),s=c[0],n=c[1];return[s,Object(r.useCallback)((function(t){localStorage.setItem(e,JSON.stringify(t.toArray())),n(t)}),[e])]}var I=[{name:"UTC",identifier:"UTC",offset:0},{name:"PDT",identifier:"America/Los_Angeles",offset:480}];var y={timezone:function(){var e=(new Date).getTimezoneOffset(),t=I.reduce((function(t,c){return Math.abs(e-c.offset)<Math.abs(e-t.offset)?c:t}));return null!=t?t:I[0]}(),nameDisplay:"original"},B=Object(g.c)(y),P=Object(g.c)({search:""}),D=Object(g.c)({sortBy:"next stream"});c(55),c(56);var V=function(){var e=Object(r.useState)(!1),t=Object(i.a)(e,2),c=t[0],s=t[1],n=Object(r.useState)(!1),a=Object(i.a)(n,2),h=a[0],m=a[1],O=Object(r.useRef)(null),p=function(){var e=S("site",B),t=Object(i.a)(e,3),c=t[0],s=t[1],n=t[2],a=S("filter",P),o=Object(i.a)(a,3),l=o[0],j=o[1],b=o[2],u=S("sort",D),d=Object(i.a)(u,3),h=d[0],m=d[1],f=d[2],O=C("bookmarks"),x=Object(i.a)(O,2),p=x[0],v=x[1],k=C("notifications"),g=Object(i.a)(k,2),T=g[0],N=g[1];return{sitePref:c,setSitePref:s,filterPref:l,setFilterPref:j,sortPref:h,setSortPref:m,reset:Object(r.useCallback)((function(){n(),b(),f()}),[n,b,f]),bookmarks:p,setBookmarks:v,notifications:T,setNotifications:N}}(),v=p.sitePref,k=p.sortPref,g=p.reset,T=p.bookmarks,I=p.setBookmarks,y=p.notifications,V=p.setNotifications;!function(){var e=Object(r.useState)("default"),t=Object(i.a)(e,2),c=t[0],s=t[1],n=Object(r.useCallback)((function(e){s(e)}),[]);Object(r.useEffect)((function(){Notification.requestPermission().then((function(e){n(e)}))}),[n])}();var _=Object(r.useCallback)((function(){window.confirm("Press OK to clear all bookmarks, filters, etc. from this web page.")&&g()}),[g]);return Object(f.jsxs)("div",{className:"app d-flex flex-column h-100",children:[Object(f.jsx)(d.a,{expand:"md",children:Object(f.jsxs)(o.a,{children:[Object(f.jsx)(d.a.Brand,{href:"#",children:"VTuber Schedules"}),Object(f.jsx)(d.a.Toggle,{"aria-controls":"navbar"}),Object(f.jsx)(d.a.Collapse,{id:"navbar",children:Object(f.jsxs)(u.a,{className:"ml-auto",children:[Object(f.jsx)(u.a.Link,{href:"#",onClick:_,children:"Clear Data"}),Object(f.jsx)(u.a.Link,{href:"#",onClick:function(){return s(!0)},children:"About"})]})})]})}),Object(f.jsx)(o.a,{className:"px-3 px-md-0",children:Object(f.jsx)(j.a,{children:Object(f.jsx)(j.a.Row,{children:Object(f.jsx)(j.a.Group,{as:l.a,className:"m-0",children:Object(f.jsxs)(b.a,{className:"mb-2 mr-sm-2",children:[Object(f.jsx)(b.a.Prepend,{children:Object(f.jsx)(b.a.Text,{children:Object(f.jsx)("span",{className:"material-icons",children:"search"})})}),Object(f.jsx)(j.a.Control,{id:"search",placeholder:"v:pikamee g:voms title"}),Object(f.jsx)(b.a.Append,{children:Object(f.jsx)(b.a.Text,{className:"help",onClick:function(){return m(!0)},children:Object(f.jsx)("span",{className:"material-icons",children:"help_outline"})})})]})})})})}),Object(f.jsx)(o.a,{className:"schedule px-3 px-md-0 my-2",ref:O,children:Object(f.jsx)(N,{parent:O,sitePref:v,sortPref:k,bookmarks:T,setBookmarks:I,notifications:y,setNotifications:V})}),Object(f.jsx)(x,{show:c,handleClose:function(){return s(!1)}}),Object(f.jsx)(w,{show:h,handleClose:function(){return m(!1)}})]})};c(58);a.a.render(Object(f.jsx)(s.a.StrictMode,{children:Object(f.jsx)(V,{})}),document.getElementById("root"))}},[[59,1,2]]]);
//# sourceMappingURL=main.73275b80.chunk.js.map