{"version":3,"sources":["Icon.tsx","AboutModal.tsx","ListSchedule.tsx","SearchHelpModal.tsx","useStoredRecord.ts","useStoredSet.ts","usePreferences.ts","useScheduleData.ts","App.tsx","usePoller.ts","useNotifications.tsx","index.tsx"],"names":["Icon","props","children","className","AboutModal","show","handleClose","notificationPermission","showNotification","useState","showEmail","setShowEmail","Modal","onHide","Header","closeButton","Title","Body","Button","onClick","process","variant","href","target","rel","Footer","Status","getStatus","stream","now","endTime","valueOf","startTime","getTime","LIVE","ENDED","UPCOMING","countQuotes","s","count","i","length","charAt","parseFilterQuery","query","parts","split","quotedParts","quotes","replaceAll","push","splitQuery","map","part","cleanQuery","toLowerCase","startsWith","vtuberName","substring","matches","vtubers","vtuber","get","vtuberId","name","includes","romanizedName","bookmarks","has","_","notifications","title","parseCondition","filter","condition","ListSchedule","streams","setBookmarks","setNotifications","filterPref","container","useRef","firstView","setFirstView","filteredStreams","useMemo","conditions","valueSeq","every","toList","sortedStreams","sort","a","b","aStatus","bStatus","nextStream","find","scrollToCurrentStream","useCallback","current","item","document","getElementById","streamId","scrollIntoView","items","hasBookmark","hasNotification","moment","status","Row","id","Col","xs","md","remove","add","lg","link","src","thumbnail","alt","shortName","format","from","useEffect","ref","SearchHelpModal","useStoredRecord","key","factory","localStorage","getItem","JSON","parse","e","getRecordOrDefault","value","setValueInner","newValue","setItem","stringify","toJSON","removeItem","useStoredSet","Set","console","error","getOrDefault","toArray","TIMEZONES","identifier","offset","DEFAULT_SITE_PREF","timezone","Date","getTimezoneOffset","reduce","minTimezone","Math","abs","getDefaultTimezone","nameDisplay","RSitePref","Record","RFilterPref","search","RSortPref","sortBy","useScheduleData","Map","setVtubers","OrderedMap","setStreams","streamsByVtuber","setStreamsByVtuber","fetchData","last","fetch","cache","then","response","json","data","set","newStreams","source","membership","parseStream","groupBy","collection","toMap","catch","interval","setInterval","clearInterval","GET_CURRENT_TIME","App","aboutModalVisible","setAboutModalVisible","searchHelpModalVisible","setSearchHelpModalVisible","schedule","triggers","callback","intervalMs","defaultValue","result","setResult","newResult","usePoller","sitePref","setSitePref","clearSitePref","setFilterPref","clearFilterPref","sortPref","setSortPref","clearSortPref","reset","usePreferences","permission","setPermission","body","icon","window","Notification","toast","updateNotificationPermission","requestPermission","useNotifications","clearData","confirm","handleSearch","event","acc","isAfter","isBefore","Navbar","expand","Container","Brand","Text","Toggle","aria-controls","Collapse","Nav","Link","Form","Group","as","InputGroup","Prepend","Control","placeholder","onChange","Append","autoClose","closeOnClick","draggablePercent","hideProgressBar","newestOnTop","pauseOnFocusLoss","position","transition","Slide","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.1b02fc36.chunk.js","sourcesContent":["export default function Icon(props: {\n  children: string;\n  className?: string;\n}): JSX.Element {\n  const { children, className = \"\" } = props;\n  return <span className={`material-icons ${className}`}>{children}</span>;\n}\n","import { useState } from \"react\";\nimport Button from \"react-bootstrap/Button\";\nimport Modal from \"react-bootstrap/Modal\";\n\nimport Icon from \"./Icon\";\n\nexport default function AboutModal(props: {\n  show: boolean;\n  handleClose: () => void;\n  notificationPermission: NotificationPermission;\n  showNotification: (\n    title: string,\n    body: string,\n    link: string,\n    icon: string\n  ) => void;\n}) {\n  const { show, handleClose, notificationPermission, showNotification } = props;\n\n  const [showEmail, setShowEmail] = useState<boolean>(false);\n\n  return (\n    <Modal show={show} onHide={handleClose}>\n      <Modal.Header closeButton>\n        <Modal.Title>VTuber Streams</Modal.Title>\n      </Modal.Header>\n      <Modal.Body>\n        <p>\n          A page to check, search, and get notifications about VTuber streams.\n        </p>\n        <ul>\n          <li>\n            <Icon>star_outline</Icon> to bookmark a VTuber\n          </li>\n          <li>\n            <Icon>notifications_none</Icon> to receive notifications for a\n            VTuber (notifications are{\" \"}\n            <b>\n              {notificationPermission === \"granted\" ? \"allowed\" : \"blocked\"}\n            </b>\n            ,{\" \"}\n            <Button\n              className=\"align-baseline\"\n              onClick={() =>\n                showNotification(\n                  \"Test notification\",\n                  \"This is a test notification\",\n                  \"#\",\n                  `${process.env.PUBLIC_URL}/placeholder.png`\n                )\n              }\n              variant=\"outline-primary\"\n            >\n              test notification\n            </Button>\n            )\n          </li>\n          <li>\n            <b>Clear Data</b> will clear all data on this website\n          </li>\n        </ul>\n        <p>\n          Send questions or feedback to{\" \"}\n          {showEmail ? (\n            <a href=\"mailto:erin.xi@outlook.com\">erin.xi@outlook.com</a>\n          ) : (\n            <Button\n              className=\"align-baseline\"\n              onClick={() => setShowEmail(true)}\n              variant=\"outline-primary\"\n            >\n              Show Email\n            </Button>\n          )}{\" \"}\n          or{\" \"}\n          <a\n            href=\"https://discordapp.com/users/659617582298562570\"\n            target=\"_blank\"\n            rel=\"noreferrer\"\n          >\n            enxi#0410\n          </a>\n          .\n        </p>\n      </Modal.Body>\n      <Modal.Footer>\n        <Button variant=\"primary\" onClick={handleClose}>\n          Close\n        </Button>\n      </Modal.Footer>\n    </Modal>\n  );\n}\n","import { List, Record, Map, Set } from \"immutable\";\nimport moment from \"moment-timezone\";\nimport { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport Col from \"react-bootstrap/Col\";\nimport Row from \"react-bootstrap/Row\";\n\nimport Icon from \"./Icon\";\nimport { Stream, VTuber } from \"./types\";\nimport { FilterPref, SitePref } from \"./usePreferences\";\n\nimport \"./ListSchedule.scss\";\n\nenum Status {\n  ENDED,\n  LIVE,\n  UPCOMING,\n}\n\ntype Condition = {\n  matches(\n    stream: Stream,\n    vtubers: Map<string, VTuber>,\n    bookmarks: Set<string>,\n    notifications: Set<string>\n  ): boolean;\n};\n\nfunction getStatus(stream: Stream, now: moment.Moment): Status {\n  if (stream.endTime == null && now.valueOf() > stream.startTime.getTime()) {\n    return Status.LIVE;\n  }\n  if (now.valueOf() >= stream.startTime.getTime()) {\n    return Status.ENDED;\n  }\n  return Status.UPCOMING;\n}\n\nfunction countQuotes(s: string): number {\n  let count = 0;\n  for (let i = 0; i < s.length; i++) {\n    if (s.charAt(i) === '\"') {\n      count++;\n    }\n  }\n  return count;\n}\n\nfunction splitQuery(query: string): string[] {\n  const parts: string[] = query.split(\" \");\n  const quotedParts: string[] = [];\n  let quotes = 0;\n  for (let i = 0; i < parts.length; i++) {\n    if (quotes % 2 === 1) {\n      quotedParts[quotedParts.length - 1] += \" \" + parts[i].replaceAll('\"', \"\");\n    } else {\n      quotedParts.push(parts[i].replaceAll('\"', \"\"));\n    }\n    quotes += countQuotes(parts[i]);\n  }\n  return quotedParts;\n}\n\nfunction parseCondition(query: string): Condition {\n  const cleanQuery = query.toLowerCase();\n\n  if (cleanQuery.startsWith(\"v:\")) {\n    const vtuberName = cleanQuery.substring(2);\n    return {\n      matches: (stream: Stream, vtubers: Map<string, VTuber>): boolean => {\n        const vtuber = vtubers.get(stream.vtuberId);\n        return (\n          vtuber != null &&\n          (vtuber.name.toLowerCase().includes(vtuberName) ||\n            vtuber.romanizedName.toLowerCase().includes(vtuberName))\n        );\n      },\n    };\n    /*\n  } else if (cleanQuery.startsWith(\"g:\")) {\n    const groupName = cleanQuery.substring(2);\n    return {\n      matches: (stream: Stream): boolean => {\n        const vtuber = vtubers.get(stream.vtuberId);\n        return vtuber.group.toLowerCase().includes(groupName);\n      },\n    };\n    */\n  } else if (cleanQuery === \"bookmark\" || cleanQuery === \"bookmarks\") {\n    return {\n      matches: (\n        stream: Stream,\n        vtubers: Map<string, VTuber>,\n        bookmarks: Set<string>\n      ): boolean => {\n        const vtuber = vtubers.get(stream.vtuberId);\n        return vtuber != null && bookmarks.has(vtuber.vtuberId);\n      },\n    };\n  } else if (cleanQuery === \"notification\" || cleanQuery === \"notifications\") {\n    return {\n      matches: (\n        stream: Stream,\n        vtubers: Map<string, VTuber>,\n        _: Set<string>,\n        notifications: Set<string>\n      ): boolean => {\n        const vtuber = vtubers.get(stream.vtuberId);\n        return vtuber != null && notifications.has(vtuber.vtuberId);\n      },\n    };\n  } else {\n    return {\n      matches: (stream: Stream, vtubers: Map<string, VTuber>): boolean => {\n        const vtuber = vtubers.get(stream.vtuberId);\n        return (\n          stream.title.toLowerCase().includes(cleanQuery) ||\n          stream.vtuberId.toLowerCase().includes(cleanQuery) ||\n          (vtuber != null &&\n            (vtuber.name.toLowerCase().includes(cleanQuery) ||\n              vtuber.romanizedName.toLowerCase().includes(cleanQuery)))\n        );\n      },\n    };\n  }\n}\n\nfunction parseFilterQuery(query: string): Condition[] {\n  const parts = splitQuery(query);\n  return parts\n    .map((part: string): Condition | null => parseCondition(part))\n    .filter(\n      (condition: Condition | null): condition is Condition => condition != null\n    );\n}\n\nexport default function ListSchedule(props: {\n  streams: Map<string, Stream>;\n  vtubers: Map<string, VTuber>;\n  sitePref: Record<SitePref>;\n  filterPref: Record<FilterPref>;\n  bookmarks: Set<string>;\n  setBookmarks: (bookmarks: Set<string>) => void;\n  notifications: Set<string>;\n  setNotifications: (notifications: Set<string>) => void;\n  now: moment.Moment;\n}) {\n  const {\n    streams,\n    vtubers,\n    bookmarks,\n    setBookmarks,\n    notifications,\n    setNotifications,\n    filterPref,\n    now,\n  } = props;\n\n  const container = useRef<HTMLDivElement>(null);\n  const [firstView, setFirstView] = useState<boolean>(true);\n\n  const filteredStreams = useMemo((): List<Stream> => {\n    const query = filterPref.get(\"search\");\n    const conditions = parseFilterQuery(query);\n    return streams\n      .valueSeq()\n      .filter((stream: Stream): boolean =>\n        conditions.every((condition: Condition): boolean =>\n          condition.matches(stream, vtubers, bookmarks, notifications)\n        )\n      )\n      .toList();\n  }, [bookmarks, filterPref, notifications, streams, vtubers]);\n\n  const sortedStreams = useMemo(\n    (): List<Stream> =>\n      filteredStreams\n        .valueSeq()\n        .sort((a: Stream, b: Stream): number => {\n          const aStatus = getStatus(a, now);\n          const bStatus = getStatus(b, now);\n          if (aStatus !== bStatus) {\n            return aStatus < bStatus ? -1 : 1;\n          }\n          if (aStatus === Status.ENDED) {\n            return (\n              (a.endTime ?? a.startTime).getTime() -\n              (b.endTime ?? b.startTime).getTime()\n            );\n          } else {\n            return a.startTime.getTime() - b.startTime.getTime();\n          }\n        })\n        .toList(),\n    [filteredStreams, now]\n  );\n\n  const nextStream = useMemo(\n    (): Stream | null =>\n      sortedStreams.find(\n        (stream: Stream): boolean =>\n          (stream.endTime == null &&\n            now.valueOf() > stream.startTime.getTime()) ||\n          now.valueOf() < stream.startTime.getTime()\n      ) ?? null,\n    [now, sortedStreams]\n  );\n\n  const scrollToCurrentStream = useCallback((): boolean => {\n    if (container.current != null && nextStream != null) {\n      const item = document.getElementById(nextStream.streamId);\n      if (item != null) {\n        item.scrollIntoView();\n        return true;\n      }\n    }\n    return false;\n  }, [nextStream]);\n\n  const items = useMemo(\n    () =>\n      sortedStreams.map((stream: Stream): JSX.Element => {\n        const vtuberId = stream.vtuberId;\n        const vtuber: VTuber = vtubers.get(vtuberId)!;\n        const hasBookmark = bookmarks.has(vtuberId);\n        const hasNotification = notifications.has(vtuberId);\n        const startTime = moment(stream.startTime);\n        const endTime = stream.endTime != null ? moment(stream.endTime) : null;\n        const status = getStatus(stream, now);\n\n        return (\n          <Row\n            key={stream.streamId}\n            id={stream.streamId}\n            className={`stream-item d-flex flex-row m-0 py-2 ${Status[\n              status\n            ].toLowerCase()} ${\n              nextStream?.streamId === stream.streamId ? \"next-stream\" : \"\"\n            }`}\n          >\n            <Col xs={2} md={1} className=\"stream-toggles text-center\">\n              <div\n                className={`toggle-bookmark ${hasBookmark ? \"active\" : \"\"}`}\n                onClick={() =>\n                  hasBookmark\n                    ? setBookmarks(bookmarks.remove(vtuberId))\n                    : setBookmarks(bookmarks.add(vtuberId))\n                }\n              >\n                <Icon>{hasBookmark ? \"star\" : \"star_outline\"}</Icon>\n              </div>\n              <br />\n              <div\n                className={`toggle-notification ${\n                  hasNotification ? \"active\" : \"\"\n                }`}\n                onClick={() =>\n                  hasNotification\n                    ? setNotifications(notifications.remove(vtuberId))\n                    : setNotifications(notifications.add(vtuberId))\n                }\n              >\n                <Icon>\n                  {hasNotification\n                    ? \"notifications_active\"\n                    : \"notifications_none\"}\n                </Icon>\n              </div>\n            </Col>\n\n            <Col xs={4} md={2} lg={1} className=\"stream-vtuber p-0\">\n              <a href={vtuber.link}>\n                <img src={vtuber.thumbnail} alt={vtuber.name} />\n                <br />\n                {vtuber.shortName}\n              </a>\n            </Col>\n\n            <Col xs={6} md={3} lg={2} className=\"stream-info p-0 text-center\">\n              <a href={stream.link} target=\"_blank\" rel=\"noreferrer\">\n                <img\n                  src={\n                    stream.thumbnail ??\n                    `${process.env.PUBLIC_URL}/placeholder.png`\n                  }\n                  alt={\"Video thumbnail\"}\n                />\n              </a>\n            </Col>\n\n            <Col\n              xs={12}\n              md={6}\n              className=\"stream-title px-4 px-md-0 py-2 text-center text-md-left\"\n            >\n              <a href={stream.link} target=\"_blank\" rel=\"noreferrer\">\n                {stream.title}\n              </a>\n            </Col>\n\n            <Col xs={12} lg={2} className=\"stream-time p-0 text-center\">\n              {startTime.format(\"h:mm A\")} <br className=\"d-none d-lg-inline\" />\n              <i>\n                {endTime != null\n                  ? `ended ${endTime.from(now)}`\n                  : status === Status.LIVE\n                  ? `started ${startTime.from(now)}`\n                  : `starting ${startTime.from(now)}`}\n              </i>\n            </Col>\n          </Row>\n        );\n      }),\n    [\n      bookmarks,\n      setBookmarks,\n      notifications,\n      setNotifications,\n      nextStream,\n      now,\n      sortedStreams,\n      vtubers,\n    ]\n  );\n\n  useEffect((): void => {\n    if (firstView && sortedStreams.count() > 0) {\n      if (scrollToCurrentStream()) {\n        setFirstView(false);\n      }\n    }\n  }, [firstView, scrollToCurrentStream, sortedStreams]);\n\n  return (\n    <div className=\"list-schedule\" ref={container}>\n      {items}\n    </div>\n  );\n}\n","import React from \"react\";\nimport Button from \"react-bootstrap/Button\";\nimport Modal from \"react-bootstrap/Modal\";\n\nexport default function SearchHelpModal(props: {\n  show: boolean;\n  handleClose: () => void;\n}) {\n  const { show, handleClose } = props;\n\n  return (\n    <Modal show={show} onHide={handleClose}>\n      <Modal.Header closeButton>\n        <Modal.Title>Search Help</Modal.Title>\n      </Modal.Header>\n      <Modal.Body>\n        <p>\n          Use the search to filter for VTubers and streams. The following\n          case-insensitive search terms are supported:\n        </p>\n        <ul>\n          <li>\n            General search terms such as <code>pikamee</code> or{\" \"}\n            <code>superchat</code> filter both VTuber and video titles.\n          </li>\n          <li>\n            Terms with spaces require surrounding quotes, such as{\" \"}\n            <code>\"super chat\"</code>.\n          </li>\n          <li>\n            Specific VTubers can be searched using the <code>v:</code> prefix,\n            such as <code>v:pikamee</code>.\n          </li>\n          {/*\n          <li>\n            Specific groups can be searched using the <code>g:</code> prefix.\n            The supported groups are:\n            <ul>\n              <li>\n                <code>g:hololive</code>\n              </li>\n              <li>\n                <code>g:voms</code>\n              </li>\n            </ul>\n          </li>\n          */}\n        </ul>\n      </Modal.Body>\n      <Modal.Footer>\n        <Button variant=\"primary\" onClick={handleClose}>\n          Close\n        </Button>\n      </Modal.Footer>\n    </Modal>\n  );\n}\n","import { Record } from \"immutable\";\nimport { useCallback, useState } from \"react\";\n\nfunction getRecordOrDefault<T>(\n  key: string,\n  factory: (values?: any) => Record<T>\n): Record<T> {\n  const item = localStorage.getItem(key);\n  if (item != null) {\n    try {\n      return factory(JSON.parse(item));\n    } catch (e) {\n      return factory();\n    }\n  }\n  return factory();\n}\n\nexport default function useStoredRecord<T>(\n  key: string,\n  factory: (values?: any) => Record<T>\n): [Record<T>, (value: Record<T>) => void, () => void] {\n  const [value, setValueInner] = useState<Record<T>>(\n    getRecordOrDefault<T>(key, factory)\n  );\n\n  const setValue = useCallback(\n    (newValue: Record<T>): void => {\n      localStorage.setItem(key, JSON.stringify(newValue.toJSON()));\n      setValueInner(newValue);\n    },\n    [key]\n  );\n\n  const clearValue = useCallback(() => {\n    localStorage.removeItem(key);\n    setValueInner(factory());\n  }, [factory, key]);\n\n  return [value, setValue, clearValue];\n}\n","import { Set } from \"immutable\";\nimport { useCallback, useState } from \"react\";\n\nfunction getOrDefault(key: string): Set<string> {\n  const item = localStorage.getItem(key);\n  if (item != null) {\n    try {\n      return Set(JSON.parse(item) as unknown as string[]);\n    } catch (e) {\n      console.error(e);\n    }\n  }\n  return Set();\n}\n\nexport default function useStoredSet(\n  key: string\n): [Set<string>, (value: Set<string>) => void] {\n  const [value, setValueInner] = useState<Set<string>>(getOrDefault(key));\n\n  const setValue = useCallback(\n    (newValue: Set<string>) => {\n      localStorage.setItem(key, JSON.stringify(newValue.toArray()));\n      setValueInner(newValue);\n    },\n    [key]\n  );\n\n  return [value, setValue];\n}\n","import { Record, Set } from \"immutable\";\nimport { useCallback } from \"react\";\n\nimport { NameDisplay, SortBy, Timezone } from \"./types\";\nimport useStoredRecord from \"./useStoredRecord\";\nimport useStoredSet from \"./useStoredSet\";\n\nexport const TIMEZONES: Timezone[] = [\n  { name: \"UTC\", identifier: \"UTC\", offset: 0 },\n  { name: \"PDT\", identifier: \"America/Los_Angeles\", offset: 480 },\n];\n\nexport const NAME_DISPLAYS: NameDisplay[] = [\"original\", \"romaji\", \"short\"];\n\nexport const SORT_BYS: SortBy[] = [\"next stream\", \"popularity\", \"random\"];\n\nfunction getDefaultTimezone(): Timezone {\n  const offset = new Date().getTimezoneOffset();\n  const timezone = TIMEZONES.reduce((minTimezone, timezone) =>\n    Math.abs(offset - timezone.offset) < Math.abs(offset - minTimezone.offset)\n      ? timezone\n      : minTimezone\n  );\n  if (timezone != null) {\n    return timezone;\n  }\n\n  // Return UTC\n  return TIMEZONES[0];\n}\n\nexport type SitePref = {\n  timezone: Timezone;\n  nameDisplay: NameDisplay;\n};\n\nconst DEFAULT_SITE_PREF: SitePref = {\n  timezone: getDefaultTimezone(),\n  nameDisplay: \"original\",\n};\n\nexport type FilterPref = {\n  search: string;\n};\n\nconst DEFAULT_FILTER_PREF: FilterPref = {\n  search: \"\",\n};\n\nexport type SortPref = {\n  sortBy: SortBy;\n};\n\nconst DEFAULT_SORT_PREF: SortPref = {\n  sortBy: \"next stream\",\n};\n\nexport const RSitePref = Record<SitePref>(DEFAULT_SITE_PREF);\nexport const RFilterPref = Record<FilterPref>(DEFAULT_FILTER_PREF);\nexport const RSortPref = Record<SortPref>(DEFAULT_SORT_PREF);\n\nexport default function usePreferences() {\n  const [sitePref, setSitePref, clearSitePref] = useStoredRecord<SitePref>(\n    \"site\",\n    RSitePref\n  );\n  const [filterPref, setFilterPref, clearFilterPref] =\n    useStoredRecord<FilterPref>(\"filter\", RFilterPref);\n  const [sortPref, setSortPref, clearSortPref] = useStoredRecord<SortPref>(\n    \"sort\",\n    RSortPref\n  );\n  const [bookmarks, setBookmarks] = useStoredSet(\"bookmarks\");\n  const [notifications, setNotifications] = useStoredSet(\"notifications\");\n\n  const reset = useCallback(() => {\n    clearSitePref();\n    clearFilterPref();\n    clearSortPref();\n    setBookmarks(Set());\n    setNotifications(Set());\n  }, [\n    clearSitePref,\n    clearFilterPref,\n    clearSortPref,\n    setBookmarks,\n    setNotifications,\n  ]);\n\n  return {\n    sitePref,\n    setSitePref,\n    filterPref,\n    setFilterPref,\n    sortPref,\n    setSortPref,\n    reset,\n    bookmarks,\n    setBookmarks,\n    notifications,\n    setNotifications,\n  };\n}\n","import { List, Map, OrderedMap } from \"immutable\";\nimport { useCallback, useEffect, useState } from \"react\";\n\nimport {\n  ScheduleData,\n  SerializedStream,\n  Stream,\n  StreamId,\n  StreamSource,\n  VTuberId,\n  VTuber,\n} from \"./types\";\n\nconst ONE_MINUTE_MS = 60 * 1000;\n\nfunction parseStream(stream: SerializedStream): Stream {\n  return {\n    streamId: stream.streamId,\n    vtuberId: stream.vtuberId,\n    source: stream.source as StreamSource | null,\n    title: stream.title,\n    link: stream.link,\n    thumbnail: stream.thumbnail,\n    startTime: new Date(stream.startTime),\n    endTime: stream.endTime != null ? new Date(stream.endTime) : null,\n    membership: stream.membership === 1,\n  };\n}\n\nexport default function useScheduleData() {\n  const [vtubers, setVtubers] = useState<Map<VTuberId, VTuber>>(Map());\n  const [streams, setStreams] = useState<Map<StreamId, Stream>>(OrderedMap());\n  const [streamsByVtuber, setStreamsByVtuber] = useState<\n    Map<VTuberId, List<Stream>>\n  >(Map());\n\n  const fetchData = useCallback((last?: number): void => {\n    fetch(`https://vtuber-streams-data.herokuapp.com/latest.json`, {\n      cache: \"no-cache\",\n    })\n      .then((response) => response.json())\n      .then((data: ScheduleData) => {\n        setVtubers(\n          data.vtubers.reduce(\n            (vtubers, vtuber) =>\n              vtubers.has(vtuber.vtuberId)\n                ? vtubers\n                : vtubers.set(vtuber.vtuberId, vtuber),\n            Map<VTuberId, VTuber>()\n          )\n        );\n        const newStreams = data.streams.reduce(\n          (streams, stream) =>\n            streams.has(stream.streamId)\n              ? streams\n              : streams.set(stream.streamId, parseStream(stream)),\n          OrderedMap<StreamId, Stream>()\n        );\n        setStreams(newStreams);\n        setStreamsByVtuber(\n          newStreams\n            .valueSeq()\n            .groupBy((stream) => stream.vtuberId)\n            .map((collection) => collection.toList())\n            .toMap()\n        );\n      })\n      .catch((e) => console.error(e));\n  }, []);\n\n  useEffect((): (() => void) => {\n    fetchData();\n\n    let last = Date.now();\n    const interval = setInterval((): void => {\n      fetchData(last);\n      last = Date.now();\n    }, ONE_MINUTE_MS);\n\n    return () => clearInterval(interval);\n  }, [fetchData]);\n\n  return { vtubers, streams, streamsByVtuber };\n}\n","import { Map } from \"immutable\";\nimport moment from \"moment-timezone\";\nimport {\n  ChangeEvent,\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from \"react\";\nimport Container from \"react-bootstrap/Container\";\nimport Col from \"react-bootstrap/Col\";\nimport Form from \"react-bootstrap/Form\";\nimport InputGroup from \"react-bootstrap/InputGroup\";\nimport Nav from \"react-bootstrap/Nav\";\nimport Navbar from \"react-bootstrap/Navbar\";\nimport Row from \"react-bootstrap/Row\";\nimport { Slide, ToastContainer } from \"react-toastify\";\n\nimport AboutModal from \"./AboutModal\";\nimport ListSchedule from \"./ListSchedule\";\nimport SearchHelpModal from \"./SearchHelpModal\";\nimport { Stream } from \"./types\";\nimport useNotifications from \"./useNotifications\";\nimport usePoller from \"./usePoller\";\nimport usePreferences from \"./usePreferences\";\nimport useScheduleData from \"./useScheduleData\";\n\nimport \"./App.scss\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\n\ntype TriggerState = \"after\" | \"before\" | \"unknown\";\n\nconst TEN_SECONDS_MS = 10 * 1000;\nconst ONE_HOUR_MS = 60 * 60 * 1000;\n\nconst GET_CURRENT_TIME = () => moment();\n\nfunction App() {\n  const [aboutModalVisible, setAboutModalVisible] = useState<boolean>(false);\n  const [searchHelpModalVisible, setSearchHelpModalVisible] =\n    useState<boolean>(false);\n  const schedule = useRef<HTMLDivElement>(null);\n  const triggers = useRef<Map<string, TriggerState>>(Map());\n\n  const now = usePoller<moment.Moment>(\n    GET_CURRENT_TIME,\n    TEN_SECONDS_MS,\n    moment()\n  );\n\n  const {\n    sitePref,\n    filterPref,\n    setFilterPref,\n    reset,\n    bookmarks,\n    setBookmarks,\n    notifications,\n    setNotifications,\n  } = usePreferences();\n\n  const { notificationPermission, showNotification } = useNotifications();\n\n  const { vtubers, streams } = useScheduleData();\n\n  const search = useMemo((): string => filterPref.get(\"search\"), [filterPref]);\n\n  const clearData = useCallback((): void => {\n    if (\n      window.confirm(\n        \"Press OK to clear all bookmarks, filters, etc. from this web page.\"\n      )\n    ) {\n      reset();\n    }\n  }, [reset]);\n\n  const handleSearch = useCallback(\n    (event: ChangeEvent<HTMLInputElement>): void => {\n      setFilterPref(filterPref.set(\"search\", event.target.value));\n    },\n    [filterPref, setFilterPref]\n  );\n\n  useEffect((): void => {\n    triggers.current = streams.reduce(\n      (\n        acc: Map<string, TriggerState>,\n        stream: Stream\n      ): Map<string, TriggerState> => {\n        if (acc.has(stream.streamId)) {\n          if (\n            acc.get(stream.streamId) === \"before\" &&\n            now.isAfter(stream.startTime)\n          ) {\n            const vtuber = vtubers.get(stream.vtuberId)!;\n            if (notifications.has(vtuber.vtuberId)) {\n              showNotification(\n                `${vtuber.shortName}'s stream is starting!`,\n                stream.title,\n                stream.link,\n                stream.thumbnail ?? vtuber.thumbnail\n              );\n            }\n            return acc.set(stream.streamId, \"after\");\n          } else {\n            return acc;\n          }\n        } else {\n          return acc.set(\n            stream.streamId,\n            now.isBefore(stream.startTime) ? \"before\" : \"after\"\n          );\n        }\n      },\n      triggers.current\n    );\n  }, [notifications, now, showNotification, streams, vtubers]);\n\n  return (\n    <div className=\"app d-flex flex-column h-100\">\n      <Navbar expand=\"md\">\n        <Container className=\"px-0 px-md-1\">\n          <Navbar.Brand href=\"#\">VTuber Streams</Navbar.Brand>\n          <Navbar.Text>{now.format(\"h:mm A\")}</Navbar.Text>\n          <Navbar.Toggle aria-controls=\"navbar\" />\n          <Navbar.Collapse id=\"navbar\">\n            <Nav className=\"ml-auto\">\n              <Nav.Link href=\"#\" onClick={clearData}>\n                Clear Data\n              </Nav.Link>\n              <Nav.Link href=\"#\" onClick={() => setAboutModalVisible(true)}>\n                About\n              </Nav.Link>\n              {/*\n              <NavDropdown id=\"timezone\" title={sitePref.get(\"timezone\").name}>\n                {TIMEZONES.map((timezone) => (\n                  <NavDropdown.Item\n                    key={timezone.name}\n                    onClick={() =>\n                      setSitePref(sitePref.set(\"timezone\", timezone))\n                    }\n                  >\n                    {timezone.name}\n                  </NavDropdown.Item>\n                ))}\n              </NavDropdown>\n              <NavDropdown\n                id=\"name_display\"\n                title={sitePref.get(\"nameDisplay\")}\n              >\n                {NAME_DISPLAYS.map((nameDisplay) => (\n                  <NavDropdown.Item\n                    key={nameDisplay}\n                    className=\"text-capitalize\"\n                    onClick={() =>\n                      setSitePref(sitePref.set(\"nameDisplay\", nameDisplay))\n                    }\n                  >\n                    {nameDisplay}\n                  </NavDropdown.Item>\n                ))}\n              </NavDropdown>\n              */}\n            </Nav>\n          </Navbar.Collapse>\n        </Container>\n      </Navbar>\n      <Container className=\"px-3 px-sm-0\">\n        <Row>\n          <Form.Group as={Col} className=\"m-0\">\n            <InputGroup className=\"mb-2 mr-sm-2\">\n              <InputGroup.Prepend>\n                <InputGroup.Text>\n                  <span className=\"material-icons\">search</span>\n                </InputGroup.Text>\n              </InputGroup.Prepend>\n              <Form.Control\n                id=\"search\"\n                placeholder=\"v:pikamee title\"\n                onChange={handleSearch}\n                value={search}\n              />\n              <InputGroup.Append>\n                <InputGroup.Text\n                  className=\"help\"\n                  onClick={() => setSearchHelpModalVisible(true)}\n                >\n                  <span className=\"material-icons\">help_outline</span>\n                </InputGroup.Text>\n              </InputGroup.Append>\n            </InputGroup>\n          </Form.Group>\n          {/*\n            <Form.Group as={Col} className=\"m-0\">\n              <Dropdown>\n                <Dropdown.Toggle id=\"sort\" className=\"text-capitalize\">\n                  Sort by: {sortPref.get(\"sortBy\")}\n                </Dropdown.Toggle>\n                <Dropdown.Menu>\n                  {SORT_BYS.map((sortBy) => (\n                    <Dropdown.Item\n                      key={sortBy}\n                      className=\"text-capitalize\"\n                      onClick={() =>\n                        setSortPref(sortPref.set(\"sortBy\", sortBy))\n                      }\n                    >\n                      {sortBy}\n                    </Dropdown.Item>\n                  ))}\n                </Dropdown.Menu>\n              </Dropdown>\n            </Form.Group>\n            */}\n        </Row>\n      </Container>\n      <Container className=\"schedule px-0 mt-2\" ref={schedule}>\n        <ListSchedule\n          streams={streams}\n          vtubers={vtubers}\n          sitePref={sitePref}\n          filterPref={filterPref}\n          bookmarks={bookmarks}\n          setBookmarks={setBookmarks}\n          notifications={notifications}\n          setNotifications={setNotifications}\n          now={now}\n        />\n      </Container>\n      <AboutModal\n        show={aboutModalVisible}\n        handleClose={() => setAboutModalVisible(false)}\n        notificationPermission={notificationPermission}\n        showNotification={showNotification}\n      />\n      <SearchHelpModal\n        show={searchHelpModalVisible}\n        handleClose={() => setSearchHelpModalVisible(false)}\n      />\n      <ToastContainer\n        autoClose={ONE_HOUR_MS}\n        closeOnClick={true}\n        draggablePercent={50}\n        hideProgressBar={true}\n        newestOnTop={true}\n        pauseOnFocusLoss={false}\n        position=\"top-center\"\n        transition={Slide}\n      />\n    </div>\n  );\n}\n\nexport default App;\n","import { useEffect, useState } from \"react\";\n\nexport default function usePoller<T>(\n  callback: () => T,\n  intervalMs: number,\n  defaultValue: T\n): T {\n  const [result, setResult] = useState<T>(defaultValue);\n\n  useEffect(() => {\n    const checkCallback = () => {\n      const newResult = callback();\n      if (result !== newResult) {\n        setResult(newResult);\n      }\n    };\n    const interval = setInterval(checkCallback, intervalMs);\n\n    return () => clearInterval(interval);\n  }, [callback, intervalMs, result]);\n\n  return result;\n}\n","import { useCallback, useEffect, useState } from \"react\";\nimport { toast } from \"react-toastify\";\n\nimport \"react-toastify/dist/ReactToastify.min.css\";\n\nexport default function useNotifications(): {\n  notificationPermission: NotificationPermission;\n  showNotification: (\n    title: string,\n    body: string,\n    link: string,\n    icon: string\n  ) => void;\n} {\n  const [permission, setPermission] =\n    useState<NotificationPermission>(\"default\");\n\n  const showNotification = useCallback(\n    (title: string, body: string, link: string, icon: string): void => {\n      if (window.Notification != null && permission === \"granted\") {\n        new window.Notification(title, { body, icon });\n      } else {\n        // Show a toast instead\n        toast(\n          <div className=\"notification-toast\" key={link}>\n            <img alt={`${title} notification icon`} src={icon} />\n            <div>\n              <h1>{title}</h1>\n              <p>\n                <a href={link} rel=\"noreferrer\" target=\"_blank\">\n                  {body}\n                </a>\n              </p>\n            </div>\n          </div>\n        );\n      }\n    },\n    [permission]\n  );\n\n  const updateNotificationPermission = useCallback(\n    (permission: NotificationPermission): void => {\n      setPermission(permission);\n    },\n    []\n  );\n\n  useEffect((): void => {\n    if (window.Notification != null) {\n      window.Notification.requestPermission().then(\n        (permission: NotificationPermission): void => {\n          updateNotificationPermission(permission);\n        }\n      );\n    }\n  }, [updateNotificationPermission]);\n\n  return { notificationPermission: permission, showNotification };\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport App from \"./App\";\nimport \"./index.css\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}